# ConfiguraÃ§Ã£o para persistence local (In-Memory)
# OTIMIZADA: Minimiza snapshots para melhor performance

include "application.conf"

pekko {
    persistence {
      journal {
        plugin = "pekko.persistence.journal.inmem"
        auto-start-journals = ["pekko.persistence.journal.inmem"]
      }
      snapshot-store {
        plugin = "pekko.persistence.snapshot-store.local"
        auto-start-snapshot-stores = ["pekko.persistence.snapshot-store.local"]
      }
    }
}

# ConfiguraÃ§Ã£o do In-Memory Journal (sem dependÃªncias externas)
pekko.persistence.journal.inmem {
  # In-memory journal - nÃ£o precisa configuraÃ§Ã£o especial
}

# ConfiguraÃ§Ã£o do Local Snapshot Store
pekko.persistence.snapshot-store.local {
    dir = "/app/hyperbolic-time-chamber/snapshots"
}

# ðŸ†• OTIMIZAÃ‡Ã•ES DE PERFORMANCE PARA 1M SIMULAÃ‡Ã•ES
pekko.actor {
    default-dispatcher {
        type = Dispatcher
        executor = "fork-join-executor"
        fork-join-executor {
            parallelism-min = 16
            parallelism-factor = 2.0
            parallelism-max = 64
        }
        throughput = 100
    }
}

# ðŸ›‘ REDUZIR SNAPSHOTS PARA PERFORMANCE
pekko.persistence {
    # Snapshots menos frequentes para simulaÃ§Ãµes grandes
    snapshot-store.local.snapshot-interval = 10000  # Snapshot a cada 10k eventos (padrÃ£o: 1000)
    
    # ConfiguraÃ§Ãµes para reduzir overhead
    journal.inmem {
        # ConfiguraÃ§Ãµes para reduzir memory usage
        max-message-batch-size = 200
    }
}